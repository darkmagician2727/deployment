<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Song Ranking</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        .container {
            max-width: 600px;
            margin: auto;
            padding: 20px;
        }

        .song {
            margin-bottom: 10px;
        }

        .button-container {
            text-align: center;
            margin-top: 20px;
        }

        button {
            padding: 10px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>Song Ranking</h2>
    <div id="songContainer"></div>
    <div class="button-container">
        <button onclick="rankAlbums()">Rank Albums</button>
        <button onclick="startTournament()">Start Song Tournament</button>
        <button onclick="viewRanking()">View Final Ranking</button>
    </div>
</div>

<script>
    const albums = Array.from({ length: 10 }, (_, index) => ({ id: index + 1, name: `Album ${index + 1}` }));
    const songs = Array.from({ length: 300 }, (_, index) => ({ id: index + 1, name: `Song ${index + 1}`, albumId: Math.ceil((index + 1) / 30) }));

    function initializeAlbumRankings() {
        const albumRankings = {};
        albums.forEach(album => {
            albumRankings[album.id] = 0;
        });
        localStorage.setItem('albumRankings', JSON.stringify(albumRankings));
    }

    function rankAlbums() {
        initializeAlbumRankings();
        const albumRankings = JSON.parse(localStorage.getItem('albumRankings'));
        albums.forEach(album => {
            const userInput = prompt(`Rank ${album.name} (1-${albums.length}):`);
            albumRankings[album.id] = parseInt(userInput);
        });
        localStorage.setItem('albumRankings', JSON.stringify(albumRankings));
        alert('Album ranking completed.');
    }

    function initializeSongRankings() {
        const songRankings = {};
        songs.forEach(song => {
            songRankings[song.id] = 0;
        });
        localStorage.setItem('songRankings', JSON.stringify(songRankings));
    }

    function generatePairings() {
        const pairings = [];
        for (let i = 0; i < songs.length; i++) {
            for (let j = i + 1; j < songs.length; j++) {
                pairings.push({ song1: songs[i], song2: songs[j] });
            }
        }
        return pairings;
    }

    function getUserPreference(pairing) {
        const userInput = prompt(`Which song do you prefer?\n1. ${pairing.song1.name}\n2. ${pairing.song2.name}`);
        return parseInt(userInput);
    }

    function updateRankings(pairings, preferences) {
        const songRankings = JSON.parse(localStorage.getItem('songRankings'));
        pairings.forEach((pairing, index) => {
            const preference = preferences[index];
            if (preference === 1) {
                songRankings[pairing.song1.id]++;
            } else {
                songRankings[pairing.song2.id]++;
            }
        });
        localStorage.setItem('songRankings', JSON.stringify(songRankings));
    }

    function startTournament() {
        initializeSongRankings();
        const pairings = generatePairings();
        const preferences = pairings.map(pairing => getUserPreference(pairing));
        updateRankings(pairings, preferences);
        alert('Song tournament completed. Rankings updated.');
    }

    function viewRanking() {
        const songRankings = JSON.parse(localStorage.getItem('songRankings'));
        const sortedRankings = Object.entries(songRankings).sort((a, b) => b[1] - a[1]);
        
        const songContainer = document.getElementById('songContainer');
        songContainer.innerHTML = '<h3>Final Song Ranking</h3>';

        sortedRankings.forEach((entry, index) => {
            const [songId, score] = entry;
            const song = songs.find(s => s.id === parseInt(songId));
            const rank = index + 1;
            const songDiv = document.createElement('div');
            songDiv.classList.add('song');
            songDiv.textContent = `${rank}. ${song.name} (Album ${song.albumId}) - Score: ${score}`;
            songContainer.appendChild(songDiv);
        });
    }
</script>

</body>
</html>
